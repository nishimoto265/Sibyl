- date: '2025-11-01'
  time_utc: 09:56:00
  summary: 要件定義をもとにCLI・オーケストレーターをTTDで完成させた
  details:
  - uv環境とpyprojectを整備し、pytestを導入
  - OrchestratorとCLIのテストを先行作成し、tmux制御・完了検知・Boss統合まで実装
  - サービス層（WorktreeManager, CodexMonitor, LogManager, TmuxLayoutManager）をテスト駆動で構築
  reproduce:
  - uv run pytest
  result: tests 10 passed
  notes: 実TMUX制御はlibtmuxスタブで検証、実環境でのキー送出確認が今後の確認事項
- date: '2025-11-01'
  time_utc: '11:30:00'
  summary: Boss採点・スコアボード・ユーザー選択・mainマージまで実装
  details:
  - WorktreeManagerにboss用ワークツリーとfast-forwardマージ機能を追加
  - CodexMonitorでmanual session登録をサポートし、bossセッション投入を自動化
  - Orchestratorで自動スコアリング＆採用決定フローを実装し、CLIは結果表示のみ
  reproduce:
  - uv run pytest
  result: tests 12 passed
  notes: 実環境ではBossワークツリーで改良した成果をmainへマージ後、codex resumeにより継続可能
- date: '2025-11-01'
  time_utc: '19:20:00'
  summary: ワーカーペイン起動が停止していた問題を修正
  details:
  - TmuxLayoutManager.fork_workersを更新し、各ワーカーペインで直接`codex --cd <worktree>`を起動するよう変更
  - Orchestratorのフォーク処理から未実装のresumeステップを除去し、ワークツリー割当のフォールバックを排除
  - TTDでtmux/オーケストレータテストを更新し、期待するコマンドとパス検証を追加
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: 暫定対応（20:45エントリで要件どおりのフォーク処理へ差し替え）。
- date: '2025-11-01'
  time_utc: '20:45:00'
  summary: 要件定義どおりメインセッションからフォークする挙動へ再修正
  details:
  - TmuxLayoutManager.fork_workersで`codex resume <main_session_id>`実行後に`Esc`×2→`Enter`を送出する処理へ変更
  - Orchestratorで全ワーカーにワークツリーを必須割当とし、既存のresumeワークフローに合わせたエラーハンドリングを追加
  - tmux/orchestratorテストを更新し、resumeコマンド・キー入力の送信を検証
  - 起動待機のばらつきに備えてstartup_delayとキー入力間隔を導入
  - デバッグ用途で`PARALLEL_DEV_PAUSE_AFTER_RESUME=1`時にワーカーレジューム直後で停止するフックを追加
  - フォーク後は指示文を再送せずEnterのみ送るよう変更し、worker側の重複入力を解消
  - CodexMonitorでレジューム直後の既存`/done`を無視し、新規追記分のみ検出するようoffset管理を追加
  - tmux起動コマンドを`cd <path> && codex`に簡素化し、`--cd`重複指定を解消
  - Boss用ワークツリーをtmuxへ渡し、workersと同様に`codex resume`→フォークまで自動化
  - BossManagerによる自動採点を廃止し、CLI上で手動選択（selector）を必須化
  - スコアボードは完了情報主体にし、選択結果のみスコアへ反映
  - Bossが出力したJSON評価をロールアウトから抽出し、スコア・コメントとして表示/ログ化
  - `PARALLEL_DEV_DEBUG_STATE` / `PARALLEL_DEV_PAUSE_BEFORE_BOSS` で完了検知と送信タイミングをデバッグ可能に
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: 各ワーカーロールアウトIDはCodexMonitorが取得し、指示送信はtmux pane_idを用いるフローで整合
- date: '2025-11-02'
  time_utc: '19:35:00'
  summary: メインCodex停止処理をCtrl+C化
  details:
  - TmuxLayoutManager.interrupt_paneでEsc送信をやめ、Ctrl+Cを二度送るよう変更
  - tmuxマネージャテストの期待値をCtrl+C送信に合わせて更新
  - uv run pytestで全18件のテストが成功することを確認
  reproduce:
  - uv run pytest
  result: tests 18 passed
  notes: メインpaneリジューム前にcodexが確実に終了し、既存セッションへ誤送信しなくなることを狙った変更
- date: '2025-11-02'
  time_utc: '19:55:00'
  summary: 要件定義ドキュメントを現状仕様に合わせて更新
  details:
  - docs/requirement.yamlでCtrl+C中断やBoss採点フローなど最新の実装手順に揃えた
  - ログ設計・完了検知・セッションID取得の記述をCodexMonitor/LogManagerの挙動に合わせて整理
  reproduce:
  - N/A (ドキュメント更新のみ)
  result: not run (docs-only)
  notes: 今後の実装リファクタリング前提としてドキュメントの齟齬を解消
- date: '2025-11-02'
  time_utc: '20:20:00'
  summary: 日付付きモジュールを整理しログ処理を共通化
  details:
  - 日付付きのCLI/サービス/オーケストレーターのシンボリックリンクを廃止し、本体ファイルへ統合
  - HELLO系スクリプトを`hello_*`命名へリネームし、logging_utils.configure_file_loggerでログ設定を共通化
  - pytestのテストファイルを`*_test.py`へ整理し、conftestでsrcディレクトリをPATHに追加
  reproduce:
  - uv run pytest
  result: tests 19 passed
  notes: 旧ログファイル名との互換性は新テストで保証、logs/ 配下の新命名へ移行
- date: '2025-11-02'
  time_utc: '20:35:00'
  summary: HELLO系サンプルコードを削除
  details:
  - HELLO出力用スクリプトとlogging_utilsモジュールを削除し、テスト資産からも除去
  - サンプルログファイル生成フローを停止し、プロダクト本体コードのみに集中できる構成へ整理
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: サンプル削除後も本体テストは全て成功し、実CLI/サービスへの影響は確認されていない
- date: '2025-11-02'
  time_utc: '20:45:00'
  summary: Orchestrator処理フローを分割リファクタ
  details:
  - CycleLayoutデータクラスを導入し、paneとワークツリーの対応関係を保持
  - run_cycle本体を準備・worker処理・Boss処理・選択/マージの個別メソッドに分割
  - デバッグ用環境変数による一時停止ロジックを _maybe_pause に集約し重複を削減
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: 既存pytestのモック検証も全て通過し、外部APIとのインターフェース互換性を維持
- date: '2025-11-02'
  time_utc: '21:20:00'
  summary: `/attach` コマンドの外部ターミナル起動を安定化
  details:
  - macOSのosascript向けに`cd <workdir> && tmux attach -t <session>`をダブルクォートエスケープして実行する処理を追加
  - Linuxではgnome-terminal経由で同コマンドを起動し、未インストール時は`bash -lc`をフォールバックとして呼び出すように改善
  - CLIControllerから作業ディレクトリを添えてattachマネージャへ委譲し、macOS/Linux/フォールバックを網羅するテストを新設
  - `/attach auto|manual` で重複アタッチ検知を切り替えられるようにし、auto時はtmuxの既存クライアントを検出して未接続なら即座に新規アタッチ、manual時は常に新規アタッチする挙動を実装
  - auto中でも`/attach`単体入力は検知をバイパスして強制接続するよう分岐を追加し、挙動をテストで保証
  - 選択したattachモードを`.parallel-dev/settings.json`に保存し、次回起動時に復元する設定ファイルを追加
  - tmuxセッションが存在しない段階ではアタッチを実行せず、「指示送信後に再試行する」旨をログに出す安全策を導入
  - アタッチ時のコマンドから`cd`を除去し、純粋に `tmux attach -t <session>` のみを実行するよう簡素化
  - autoモード有効時は指示開始直後に自動アタッチ処理をバックグラウンドで起動し、セッション生成完了を待機してから未接続なら接続するよう調整
  - `/attach`仕様の更新内容をdocs/requirement.yamlへ反映
  reproduce:
  - uv run pytest
  result: tests 20 passed
  notes: 実tmux環境でのosascript挙動は引き続き実機での確認が必要
