- date: '2025-11-01'
  time_utc: 09:56:00
  summary: 要件定義をもとにCLI・オーケストレーターをTTDで完成させた
  details:
  - uv環境とpyprojectを整備し、pytestを導入
  - OrchestratorとCLIのテストを先行作成し、tmux制御・完了検知・Boss統合まで実装
  - サービス層（WorktreeManager, CodexMonitor, LogManager, TmuxLayoutManager）をテスト駆動で構築
  reproduce:
  - uv run pytest
  result: tests 10 passed
  notes: 実TMUX制御はlibtmuxスタブで検証、実環境でのキー送出確認が今後の確認事項
- date: '2025-11-01'
  time_utc: '19:20:00'
  summary: ワーカーペイン起動が停止していた問題を修正
  details:
  - TmuxLayoutManager.fork_workersを更新し、各ワーカーペインで直接`codex --cd <worktree>`を起動するよう変更
  - Orchestratorのフォーク処理から未実装のresumeステップを除去し、ワークツリー割当のフォールバックを排除
  - TTDでtmux/オーケストレータテストを更新し、期待するコマンドとパス検証を追加
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: 暫定対応（20:45エントリで要件どおりのフォーク処理へ差し替え）。
- date: '2025-11-01'
  time_utc: '20:45:00'
  summary: 要件定義どおりメインセッションからフォークする挙動へ再修正
  details:
  - TmuxLayoutManager.fork_workersで`codex resume <main_session_id>`実行後に`Esc`×2→`Enter`を送出する処理へ変更
  - Orchestratorで全ワーカーにワークツリーを必須割当とし、既存のresumeワークフローに合わせたエラーハンドリングを追加
  - tmux/orchestratorテストを更新し、resumeコマンド・キー入力の送信を検証
  - 起動待機のばらつきに備えてstartup_delayとキー入力間隔を導入
  - デバッグ用途で`PARALLEL_DEV_PAUSE_AFTER_RESUME=1`時にワーカーレジューム直後で停止するフックを追加
  - フォーク後は指示文を再送せずEnterのみ送るよう変更し、worker側の重複入力を解消
  - CodexMonitorでレジューム直後の既存`/done`を無視し、新規追記分のみ検出するようoffset管理を追加
  - tmux起動コマンドを`cd <path> && codex`に簡素化し、`--cd`重複指定を解消
  - Boss用ワークツリーをtmuxへ渡し、workersと同様に`codex resume`→フォークまで自動化
  - BossManagerによる自動採点を廃止し、CLI上で手動選択（selector）を必須化
  - スコアボードは完了情報主体にし、選択結果のみスコアへ反映
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: ロールアウトID検出と指示送信（pane基準）の責務を整理し、要件の並列起動フローと一致。
- date: '2025-11-02'
  time_utc: '00:57:00'
  summary: HELLOスクリプトをTTDで追加
  details:
  - 失敗するpytestを先に作成し、HELLO標準出力とログ生成を検証
  - ロガーを設定する`src/parallel_developer/25-11-02-09_hello.py`を実装し、詳細なDEBUGログを記録
  - 実装後にpytest全体を実行し、既存テストとの整合を確認
  reproduce:
  - uv run pytest tests/25-11-02-09_hello_script_test.py
  - uv run pytest
  result: tests 15 passed
  notes: 既存の25-11-01-19_.venv環境を再利用し、ログはlogs/25-11-02-09_hello.logへ出力。
- date: '2025-11-02'
  time_utc: '00:59:00'
  summary: HELLOスクリプトのログ文言を再整備
  details:
  - ログ検証を強化するpytestを作成し、HELLO標準出力とlogファイルのキーを確認
  - 25-11-02-09_hello.pyのデバッグログをhello_script_start/completeに統一
  - uv run pytestでスクリプト単体テストを実行し、既存ワークフローと競合しないことを確認
  reproduce:
  - uv run pytest tests/25-11-02-09_hello_script_test.py
  - uv run pytest
  result: tests 15 passed
  notes: logs/25-11-02-09_hello.logで実行履歴が追跡できる状態を確認
- date: '2025-11-02'
  time_utc: '01:16:19'
  summary: 新しいHELLOスクリプトをTTDで追加
  details:
  - 失敗するpytest tests/25-11-02-10_hello_script_test.pyを先に作成し、HELLO標準出力とログ生成を検証
  - 25-11-02-10_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - uv run pytestで単体および全体テストを実行し、既存動作との整合を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_script_test.py
  - uv run pytest
  result: tests 16 passed
  notes: logs/25-11-02-10_hello.logにhello_script_start/message_prepared/completeのログが出力されることを確認
- date: '2025-11-02'
  time_utc: '01:24:34'
  summary: HELLO標準出力スクリプトを追加
  details:
  - 失敗するpytest tests/25-11-02-10_simple_hello_test.pyを作成し、標準出力とログ出力を検証
  - src/parallel_developer/25-11-02-10_simple_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - uv run pytest tests/25-11-02-10_simple_hello_test.pyおよびuv run pytestで全体回帰を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_simple_hello_test.py
  - uv run pytest
  result: tests 18 passed
  notes: logs/25-11-02-10_simple_hello.logにsimple_hello_start〜completeの履歴を記録
- date: '2025-11-02'
  time_utc: '01:24:49'
  summary: HELLO標準出力スクリプトをTTDで再追加
  details:
  - 失敗するpytest tests/25-11-02-10_hello_stdout_test.pyを先に作成し、標準出力とログ内容を検証
  - 25-11-02-10_hello_stdout.pyでstart/message_prepared/completeログを出力するHELLOスクリプトを実装
  - uv run pytest tests/25-11-02-10_hello_stdout_test.pyとuv run pytestで全体回帰を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_stdout_test.py
  - uv run pytest
  result: tests 17 passed
  notes: logs/25-11-02-10_hello_stdout.logでスクリプト実行フローを追跡可能
- date: '2025-11-02'
  time_utc: '01:25:31'
  summary: HELLO標準出力スクリプトをTTDで再生成
  details:
  - tests/25-11-02-10_hello_stdout_test.pyを先に作り、HELLO標準出力とログ3種を検証
  - src/parallel_developer/25-11-02-10_hello_stdout.pyを実装し、詳細なDEBUGログとHELLO出力を追加
  - uv run pytest tests/25-11-02-10_hello_stdout_test.pyとuv run pytestで全テストを確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_stdout_test.py
  - uv run pytest
  result: tests 17 passed
  notes: logs/25-11-02-10_hello_stdout.logにhello_stdout_script_start〜completeを記録
- date: '2025-11-02'
  time_utc: '01:28:39'
  summary: HELLO標準出力スクリプトを新規追加
  details:
  - 失敗するpytest tests/25-11-02-10_test_hello.pyを先に作成し、HELLO標準出力を検証
  - src/25-11-02-10_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - ログがlogs/25-11-02-10_hello.logに記録されることを確認
  reproduce:
  - uv run pytest tests/25-11-02-10_test_hello.py
  result: tests 1 passed
  notes: 既存uv環境を再利用し、HELLO以外の標準出力は行わない
- date: '2025-11-02'
  time_utc: '19:35:00'
  summary: メインCodex停止処理をCtrl+C化
  details:
  - TmuxLayoutManager.interrupt_paneでEsc送信をやめ、Ctrl+Cを2回送るよう変更
  - tmuxマネージャテストの期待値をCtrl+C送信に合わせて更新
  - uv run pytestで全18件のテストが成功することを確認
  reproduce:
  - uv run pytest
  result: tests 18 passed
  notes: メインpaneリジューム前にcodexが確実に終了し、既存セッションへ誤送信しなくなることを狙った変更
- date: '2025-11-02'
  time_utc: '19:55:00'
  summary: 要件定義ドキュメントを現状仕様に合わせて更新
  details:
  - docs/requirement.yamlのステータス・並列起動フロー・評価/ログ設計の記述を最新実装と一致させた
  - 完了検知方式とセッションID追跡の説明をCodexMonitorの実装に沿って整理
  reproduce:
  - N/A (ドキュメント更新のみ)
  result: not run (docs-only)
  notes: 次段階のリファクタリング前にドキュメントとの齟齬を解消
- date: '2025-11-02'
  time_utc: '20:20:00'
  summary: 日付付きモジュールの整理とログ共通化
  details:
  - シンボリックリンク化されていた日付付きCLI/サービス/オーケストレーターを本体ファイルへ集約
  - HELLO系サンプルを`hello_*`命名へ統一し、logging_utils.configure_file_loggerで重複コードを排除
  - pytestテスト名を`*_test.py`へ揃え、conftestでsrcをsys.pathに追加してローカルパッケージを優先読み込み
  reproduce:
  - uv run pytest
  result: tests 19 passed
  notes: ログファイル名も`hello_*.log`へ刷新し、各テストで新しい出力を検証済み
- date: '2025-11-02'
  time_utc: '20:35:00'
  summary: HELLOサンプルと付随テストを削除
  details:
  - src/parallel_developer配下のHELLO系スクリプトとlogging_utilsを撤去
  - 対応するpytestテスト群（hello_*_test.py）を削除し、サンプルログ出力資産を整理
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: テスト削除後も本体テストは問題なく通過、今後は実プロダクトコードに専念
- date: '2025-11-02'
  time_utc: '20:45:00'
  summary: Orchestrator.run_cycleを段階処理へ分割
  details:
  - CycleLayoutデータクラスを新設し、tmuxレイアウトとワークツリー情報を一元管理
  - run_cycleをprepare/layout・worker分岐・Boss評価・選択/マージの私有メソッドへ分割し可読性向上
  - ``PARALLEL_DEV_*`` デバッグ環境変数のチェックを _maybe_pause に集約
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: 既存のpytestモックは期待どおりに呼び出しシーケンスを検証し、リファクタ後も全テスト成功
- date: '2025-11-02'
  time_utc: '21:50:00'
  summary: CommandPalette初期化でTextual例外を防止
  details:
  - CommandPaletteの__init__とset_itemsでupdate()を即時呼び出し、初回描画がNoneになる問題を解消
  - _render内の改行挿入ロジックのインデント崩れを修正し、pytestで検出されたIndentationErrorを解決
  - CLI回りのテスト群を実行し、コマンドパレットのハイライト更新が意図通り動作することを確認
  reproduce:
  - uv run pytest
  result: tests 32 passed
  notes: 実行時にAttributeError: 'NoneType' object has no attribute 'get_height'が再発しないことを手動確認
- date: '2025-11-02'
  time_utc: '22:10:00'
  summary: Textualテストでコマンドパレット挙動を再現
  details:
  - CommandPaletteの内部メソッド名を_rebuild_renderableへ変更し、Textual内部の_static._renderと衝突しないよう修正
  - renderable更新時はrefresh()のみ呼ぶよう整理し、Noneが返ることで再発していたget_height例外を根絶
  - Textualのrun_test()を使い、スラッシュ入力と矢印キー操作でパレットが開閉・遷移するUIテストを追加
  reproduce:
  - uv run pytest
  result: tests 34 passed
  notes: `.venv/bin/pdev`を直接起動せずともUIフローをpytestで再現できることを確認
- date: '2025-11-02'
  time_utc: '22:30:00'
  summary: 入力フォーカス制御とクリック操作の挙動を統一
  details:
  - EventLogをクリックしてもフォーカスが移動しないようcan_focus/focus_on_clickを無効化
  - ParallelDeveloperApp.on_clickでOptionList選択時を除き常に入力欄へフォーカスを戻す処理を追加
  - run_testベースのUIテストでログクリック・空白クリック・選択肢クリック時のフォーカス遷移を検証
  reproduce:
  - uv run pytest
  result: tests 37 passed
  notes: クリック後も端末の選択ハイライトは維持されるため、ログのドラッグ選択→コピーも可能
- date: '2025-11-02'
  time_utc: '22:55:00'
  summary: ログ選択のコピー操作をショートカット対応
  details:
  - ParallelDeveloperAppでctrl+alt+c（およびctrl+shift+c等）のショートカットを捕捉し、選択範囲優先でログ内容をクリップボードへ転送する処理を実装
  - CLIに`/log copy`・`/log save <path>`を追加し、ショートカットを使わずにログコピー／ファイル保存ができるようにした
  - 選択情報が取得できない場合はRichLog.linesからプレーンテキストを構築してコピーするフォールバックを追加
  - ctrl+a系ショートカットでログ全体を即時選択できるようにし、UIテストでショートカット経路を検証
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py
  - uv run pytest
  result: tests 38 passed
  notes: 実行環境ではマウス選択後にcmd/ctrl+shift+cでコピー可能、cmd+cは端末依存のため要確認
- date: '2025-11-02'
  time_utc: '23:10:00'
  summary: ログビューを折り返し表示に統一
  details:
  - EventLogでwrapを有効化し、CLIの横幅に合わせて自動改行されるよう調整
  - #logスタイルにoverflow-x: hiddenを適用し、横スクロールを無効化して縦方向の移動に限定
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 長文ログも横スクロールなしで読みやすくなった
- date: '2025-11-03'
  time_utc: '00:05:00'
  summary: RichLogで再描画により折り返し対応
  details:
  - EventLogを拡張し、生ログを保持してリサイズ発生時にclear→再書き込みするパスを追加
  - Text.wrapを有効化したTextを用いて出力することで、CLI幅に合わせた折り返しとログコピーの整合を確保
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 選択コピーやステータス出力の挙動は従来通り
- date: '2025-11-03'
  time_utc: '00:20:00'
  summary: コマンド入力をTextArea化し折り返し・改行を改善
  details:
  - CommandTextAreaコンポーネントを導入し、入力欄でのソフトラップとShift+Enterによる改行を実装
  - 下矢印/上矢印はコマンドパレットの選択移動へ転送し、従来のキーバインドを維持
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 長文指示でも入力欄が横スクロール無しで閲覧可能
- date: '2025-11-03'
  time_utc: '04:10:00'
  summary: Shift+Enter送信バグを再現テストでFIX
  details:
  - CommandTextAreaでShift押下状態を追跡し、Shift+Enterは改行・Enter単体は送信・Ctrl+Enterは送信に振り分け
  - 送信処理はテスト中にスタブ化し、Shift→Enter→Enterなどの実機シーケンスをUIテスト化
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py
  result: tests 46 passed
  notes: テストはtmux起動を伴わず高速に回る
- date: '2025-11-03'
  time_utc: '04:56:00'
  summary: CLI周辺のデッドコード整理を実施
  details:
  - 未使用だったSessionConfig.run_parallelプロパティを削除し実装を簡潔化
  - Textualコンテナとtypingの未使用インポートを除去して警告を解消
  reproduce:
  - uv run pytest
  result: tests 46 passed
  notes: 機能回帰なしを確認済み。今後のリファクタ準備としてコードの複雑度を軽減
- date: '2025-11-03'
  time_utc: '04:58:00'
  summary: 本格リファクタの構造計画を策定
  details:
  - CLI/Controller/UI/サービス層の責務と依存関係を棚卸し
  - docs/25-11-03-04_refactor_plan.md に段階的な再構成方針とテスト戦略をまとめた
  reproduce:
  - N/A (計画策定のみ)
  result: not run (planning-only)
  notes: フェーズ1ではCLIControllerのモジュール分割とAPI整理から着手予定
- date: '2025-11-03'
  time_utc: '05:34:00'
  summary: Textual UIコンポーネントを別モジュール化
  details:
  - CommandPaletteやCommandTextAreaなどのUIクラスを25-11-03-05_ui.pyへ移動し、cli.pyを簡素化
  - importlib.utilでタイムスタンプ付きモジュールを動的ロードし、既存テストが期待するエクスポートを維持
  - 影響範囲のpytestを実行し、全46テストが通過することを確認
  reproduce:
  - uv run pytest
  result: tests 46 passed
  notes: controller本体は今後のフェーズで分割予定。UIコンポーネントの独立により再利用とテストの見通しが向上
- date: '2025-11-03'
  time_utc: '05:45:00'
  summary: ESCキーで全tmuxペインへESC送信する処理を追加
  details:
  - CLIControllerにbroadcast_escapeを実装し、tmux list-panes/send-keysで各ペインへEscapeを送信
  - ESC押下で一時停止モードへ遷移し、追加指示は既存ペインへブロードキャストする挙動を追加
  - 二度目のESCで直前サイクルへ巻き戻す処理と、巻き戻し待機フラグを導入
  - TextualアプリのESCバインディングでcontroller.handle_escapeを呼ぶよう拡張
  - CLI/ UIテストを追加し、tmux送信コマンド・一時停止／巻き戻し・追加入力の各挙動を検証
  reproduce:
  - uv run pytest
  result: tests 52 passed
  notes: 一時停止中の追加入力がワーカーへ転送され、ESC二度押しで前回サイクルの再開点へ復帰できる
